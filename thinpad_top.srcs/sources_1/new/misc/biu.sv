`include "../defines.sv"

module biu (
    input [31:0] ifu_mem_addr,
    output [31:0] ifu_mem_data,
    output ifu_mem_valid,

    input lsu_enable,
    input lsu_store_enable,
    input [31:0] lsu_mem_addr,
    input [31:0] lsu_store_data,
    output [31:0] lsu_load_data,

    inout wire[31:0] base_ram_data,  //BaseRAM????????????8??????CPLD?????????????????????
    output reg[19:0] base_ram_addr, //BaseRAM??????
    output wire[3:0] base_ram_be_n,  //BaseRAM?????????????????????????????????????????????????????????????????????0
    output reg base_ram_ce_n,       //BaseRAM??????????????????
    output reg base_ram_oe_n,       //BaseRAM?????????????????????
    output reg base_ram_we_n        //BaseRAM?????????????????????
);
    
logic [31:0] ram_data;
assign base_ram_data = base_ram_we_n ? ram_data : 32'bz;

assign ifu_mem_valid = lsu_enable ? 1'b0 : 1'b1;
assign base_ram_we_n = (lsu_store_enable & lsu_enable) ? 1'b0 : 1'b1;
assign base_ram_oe_n = ~base_ram_we_n;
assign base_ram_ce_n = 1'b0;
assign base_ram_be_n = 4'b0;

assign base_ram_addr = lsu_enable ? lsu_mem_addr : ifu_mem_addr;
assign ifu_mem_data = lsu_enable ? 32'b0 : base_ram_data;
assign ram_data = lsu_enable & lsu_store_enable ? lsu_store_data : 32'b0;

endmodule